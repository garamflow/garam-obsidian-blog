# 1. Getting Started
## 1.1 Hello Spring Security
- 이 섹션은 [Spring Boot](https://docs.spring.io/spring-boot/docs/3.1.1/reference/html/)와 Spring Security를 사용하는 기초적인 설정 방법을 다루며, 그 이후 어떻게 나아가야 하는지 안내한다.

> [!NOTE]
> 완성된 스타터 애플리케이션은 [샘플 리포지터리](https://github.com/spring-projects/spring-security-samples/tree/6.3.x/servlet/spring-boot/java/hello-security)에서 확인 가능하다. Spring Initializr에서 제공하는 Spring Boot + Spring Security 애플리케이션을 다운로드 할 수 있다.

## 1.2 Updating Dependencies
- 먼저 Spring Security를 애플리케이션의 classpath에 추가해야 한다.
	- `dependencies`에 라이브러리 추가를 의미
- 이를 수행하기 위해서 [Maven](https://docs.spring.io/spring-security/reference/getting-spring-security.html#getting-maven-boot) 혹은 [Gradle](https://docs.spring.io/spring-security/reference/getting-spring-security.html#getting-gradle-boot)을 사용할 수 있다.

## 1.3 Starting Hello Spring Security Boot
- Spring Security가 classpath에 추가되면, Spring Boot 애플리케이션을 실행 가능하다.

### 1.3.1 자동 활성화되는 기본 보안 설정
- 아래는 애플리케이션에 Spring Security가 적용된 걸 알려주는 출력의 일부분이다.
```bash
# Gradle 예시
$ ./gradlew :bootRun
...
INFO 23689 --- [  restartedMain] .s.s.UserDetailsServiceAutoConfiguration :
Using generated security password: 8e557245-73e2-4286-969a-ff57fe326336
...
```
- Spring Boot 애플리케이션 실행 시, Spring Security가 별도 설정 없이도 자동으로 기본 보안 설정이 활성화된다.
- `Using generated security password`
	- Spring Security가 기본 보안 설정을 활성화한 것을 나타낸다.
	- 애플리케이션에 기본 로그인 페이지를 제공하고, 임시 보안 비밀번호를 사용해 접근할 수 있다.
- `8e557245-73e2-4286-969a-ff57fe326336`
	- Spring Security가 임시로 생성한 기본 로그인 비밀번호이다.
	- 애플리케이션 실행 시 매번 새로운 비밀번호가 생성된다.
	- 사용자 이름은 기본적으로 `user`로 설정된다.

### 1.3.2 인증되지 않은 엔드포인트 접근 시도 예시
- 애플리케이션이 실행되면 엔드포인트에 접근할 수 있다.
- 만약 인증 정보 없이 엔드포인트에 접속하려고 시도하면 Spring Security가 접근을 차단한다.
```bash
$ curl -i http://localhost:8080/some/path
HTTP/1.1 401
...
```
- Spring Security가 접근을 차단하고 `401 Unauthorized` 응답을 반환한다.
	- 401 응답은 인증되지 않은 사용자거나 유효하지 않은 인증 정보를 제공했음을 나타낸다.

> [!Note]
> - 브라우저에서 위와 같은 URL을 입력하면, Spring Security가 기본 로그인 페이지로 리다이렉션시킨다.
> - Spring Security는 브라우저에 의한 접근과 curl과 같은 프로그래밍적 접근에 다른 처리 방식을 보여준다.

### 1.3.3 인증 정보를 제공하고 엔드포인트 접근 시도 예시
- 엔드포인트에 인증 정보를 제공하고 접근하면 아래와 같은 결과가 나온다.
```bash
$ curl -i -u user:8e557245-73e2-4286-969a-ff57fe326336 http://localhost:8080/some/path
HTTP/1.1 404
...
```
- Spring Security가 요청을 처리하고, `/some/path` 경로가 존재하지 않아서 `404 Not Found` 응답을 반환한다.


> [!Note] 이 이후
> - [Spring Boot가 Spring Security에서 기본적으로 활성화하는 기능](https://docs.spring.io/spring-security/reference/servlet/getting-started.html#servlet-hello-auto-configuration) 이해하기
> - [Spring Security가 지원하는 일반적인 사용 사례](https://docs.spring.io/spring-security/reference/servlet/getting-started.html#security-use-cases) 살펴보기
> - [인증](https://docs.spring.io/spring-security/reference/servlet/authentication/index.html) 설정 시작하기

## 1.4 Runtime Expectiations
- Spring Boot와 Spring Security의 기본 구성은 런타임에 다음과 같은 동작을 제공한다.
	- [모든 엔드포인트](https://docs.spring.io/spring-security/reference/servlet/authorization/authorize-http-requests.html)(Spring Boot의 `/error` 엔드포인트 포함)에 대해 인증된 사용자만 접근할 수 있다.
	- 애플리케이션 시작 시 비밀번호와 [기본 사용자를 생성](https://docs.spring.io/spring-security/reference/servlet/authentication/passwords/user-details-service.html)한다.
		- 비밀번호는 콘솔 로그에 출력된다.
	- [BCrypt를 포함한 다양한 암호화 방식](https://docs.spring.io/spring-security/reference/servlet/authentication/passwords/password-encoder.html)을 사용해 안전하게 저장한다.
	- 폼 기반 [로그인](https://docs.spring.io/spring-security/reference/servlet/authentication/passwords/form.html) 및 [로그아웃](https://docs.spring.io/spring-security/reference/servlet/authentication/logout.html) 흐름을 제공한다.
	- [폼 기반 로그인](https://docs.spring.io/spring-security/reference/servlet/authentication/passwords/form.html)과 [HTTP Basic](https://docs.spring.io/spring-security/reference/servlet/authentication/passwords/basic.html)을 모두 지원한다.
	- 컨텐츠 협상을 제공한다.
		- 웹 요청은 로그인 페이지로 리다이렉트
		- 서비스 요청은 `401 Unauthorized`를 반환
	- [CSRF 공격을 완화](https://docs.spring.io/spring-security/reference/servlet/exploits/csrf.html)한다.
	- [세션 고정 공격을 완화](https://docs.spring.io/spring-security/reference/servlet/authentication/session-management.html#ns-session-fixation)한다.
	- [HTTPS 사용 보장](https://en.wikipedia.org/wiki/HTTP_Strict_Transport_Security)을 위해 [Strict-Transport-Security 헤더](https://docs.spring.io/spring-security/reference/servlet/exploits/headers.html#servlet-headers-hsts)를 작성한다.
	- [스니핑 공격을 완화](https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html#x-content-type-options)하기 위해 [X-Content-Type-Options 헤더](https://docs.spring.io/spring-security/reference/servlet/exploits/headers.html#servlet-headers-content-type-options)를 작성한다.
	- 인증된 리소스 보호를 위해 [Cache Contorl 헤더](https://docs.spring.io/spring-security/reference/servlet/exploits/headers.html#servlet-headers-cache-control)를 작성한다.
	- [클릭재킹](https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html#x-frame-options)을 완화하기 위해 [X-Frame-Options 헤더](https://docs.spring.io/spring-security/reference/servlet/exploits/headers.html#servlet-headers-frame-options)를 작성한다.
	- [`HttpServletRequest`의 인증 메서드](https://docs.spring.io/spring-security/reference/servlet/integrations/servlet-api.html)와 통합된다.
	- [인증 성공 및 실패 이벤트](https://docs.spring.io/spring-security/reference/servlet/authentication/events.html)를 발생시킨다.