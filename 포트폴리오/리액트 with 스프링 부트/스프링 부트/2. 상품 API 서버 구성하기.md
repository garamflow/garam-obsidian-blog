# 상품 API 서버 구성하기

## 12) Querydsl에서 @ElementCollection 처리하기
- 그냥 예시 코드
```java
package org.mall.shoppingmallapi.repository.search;  
  
import org.mall.shoppingmallapi.dto.PageRequestDTO;  
import org.mall.shoppingmallapi.dto.PageResponseDTO;  
import org.mall.shoppingmallapi.dto.ProductDTOTwo;  
  
public interface ProductSearchTwo {  
  
    PageResponseDTO<ProductDTOTwo> searchList (PageRequestDTO pageRequestDTO);  
}
```

```java
package org.mall.shoppingmallapi.repository.search;  
  
import com.querydsl.jpa.JPQLQuery;  
import lombok.extern.log4j.Log4j2;  
import org.mall.shoppingmallapi.domain.Product;  
import org.mall.shoppingmallapi.domain.QProduct;  
import org.mall.shoppingmallapi.domain.QProductImage;  
import org.mall.shoppingmallapi.dto.PageRequestDTO;  
import org.mall.shoppingmallapi.dto.PageResponseDTO;  
import org.mall.shoppingmallapi.dto.ProductDTOTwo;  
import org.springframework.data.domain.PageRequest;  
import org.springframework.data.domain.Pageable;  
import org.springframework.data.domain.Sort;  
import org.springframework.data.jpa.repository.support.QuerydslRepositorySupport;  
  
import java.util.List;  
  
@Log4j2  
public class ProductSearchTwoImpl extends QuerydslRepositorySupport implements ProductSearchTwo {  
  
    public ProductSearchTwoImpl() {  
        super(Product.class);  
    }  
  
    @Override  
    public PageResponseDTO<ProductDTOTwo> searchList(PageRequestDTO pageRequestDTO) {  
        log.info("---------------------------searchList--------------------------------");  
  
        Pageable pageable = PageRequest.of(  
                pageRequestDTO.getPage() -1,  
                pageRequestDTO.getSize(),  
                Sort.by("pno").descending());  
  
        QProduct product = QProduct.product;  
        QProductImage productImage = QProductImage.productImage;  
  
        JPQLQuery<Product> query = from(product);  
  
        query.leftJoin(product.imageList, productImage);  
        query.where(productImage.ord.eq(0));  
  
        getQuerydsl().applyPagination(pageable, query);  
  
        List<Product> productList = query.fetch();  
  
        long count = query.fetchCount();  
  
        log.info("----------------=====-----------");  
        log.info(productList);  
  
        return null;    }  
}
```

```java
public interface ProductRepositoryTwo extends JpaRepository<Product, Long>, ProductSearchTwo {
...
```

## 13) 상품 서비스계층 구현하기