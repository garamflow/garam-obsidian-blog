# 업로드 파일 조회 기능 구현하기
- 업로드 파일 조회의 경우 실제 파일이 아니라 파일의 데이터를 전달해주는 것이다.
	- 리소스 데이터를 전달하는 것
- 전송해주는 데이터의 MIME Type을 지정해줘야한다.
- API 서버가 파일까지 제공해줘냐에 대해서는 설계 이슈가 있다.
	- 실제로는 파일 서버가 따로 있어야한다.

```java
public ResponseEntity<Resource> getFile(String fileName) {

    Resource resource = new FileSystemResource(uploadPath + File.separator + fileName);

    if (!resource.isReadable()) {
        resource = new FileSystemResource(uploadPath + File.separator + "default.jpeg");
    }

    HttpHeaders headers = new HttpHeaders();

    try {
        headers.add("Content-Type", Files.probeContentType(resource.getFile().toPath()));
    } catch (IOException e) {
        throw new RuntimeException(e);
    }

    return ResponseEntity.ok().headers(headers).body(resource);
}
```
- `Resource resource = new FileSystemResource(uploadPath + File.separator + fileName);`
	- 요청 받은 파일 이름에 해당하는 파일 리소스를 생성한다.
	- `FileSystemResource` : 파일 시스템의 특정 파일을 나타내는 Spring의 `Resource`의 구현체
	- `uploadPath` : 파일이 저장된 디렉토리 경로
	- `File.separator` : 시스템에 따른 디렉토리 구분자('/') 또는 ('\\') 를 사용한다.
	- `fileName` : 메소드에 전달된 파일 이름
- `resource.isReadable()`
	- 리소스가 실제로 존재하고 읽을 수 있는 지 확인한다.
- `new FileSystemResource(uploadPath + File.separator + "default.jpeg");`
	- 파일이 존재하지 않거나 읽을 수 없을 경우, 기본 이미지로 대체한다.
- `Files.probeContentType(resource.getFile().toPath())`
	- 파일의 MIME 타입을 추론해서 적절한 `Content-Type`을 헤더에 설정한다.
		- JPEG 파일의 경우 `image/jpeg`
- `ResponseEntity.ok().headers(headers).body(resource);`
	- `ResponseEntity.ok()` : 상태 코드 200(OK)의 `ResponseEntity` 빌더를 생성한다.
	- `.headers(headers)` : HTTP 헤더를 응답에 포함시킨다.
	- `.body(resource)` : 클라이언트에 반환될 `Resource` 객체를 설정한다. `Resource` 는 요청된 파일 혹은 요청된 파일이 읽을 수 없는 경우 기본 이미지 리소스이다.