# 상품 서비스, 컨트롤러 계층 구현하기 - 상품 등록
## 1) 서비스 계층 - 인터페이스 - 상품 등록
```java
public interface ProductServiceTwo {  
    PageResponseDTO<ProductDTOTwo> getList(PageRequestDTO pageRequestDTO);
    Long register(ProductDTOTwo productDTOTwo);
}
```

## 2) DTO에서 Entity 변환 기능 구현하기
- DTO 객체에서 제공된 데이터를 기반으로 Entity 객체를 생성하고, 필요하면 추가적인 데이터 처리를 수행해서 결과를 반환한다.
- 서비스 계층에서 DTO 객체를 받아 데이터베이스에 저장할 Entity 객체로 변환하는 과정에 자주 사용된다.
```java
public class ProductServiceTwoImpl implements ProductServiceTwo {
	...
	private Product dtoToEntity(ProductDTOTwo productDTOTwo) {
	    // 커넥션 처리가 아닌 것들
	    Product product = Product.builder()
	            .pno(productDTOTwo.getPno())
	            .pname(productDTOTwo.getPname())
	            .pdesc(productDTOTwo.getPdesc())
	            .price(productDTOTwo.getPrice())
	            .build();
	
	    // 커넥션 처리
	    List<String> uploadedFileName = productDTOTwo.getUploadedFileName();
	
	    if(uploadedFileName == null || uploadedFileName.isEmpty()) return product;
	
	    uploadedFileName.forEach(filename -> {
	        product.addImageString(filename);
	    });
	
	    return product;
	}
	...
}
```

## 3) 서비스 계층 - 서비스 클래스 - 상품 등록
```java
public class ProductServiceTwoImpl implements ProductServiceTwo {
	...
	@Override
	public Long register(ProductDTOTwo productDTOTwo) {
	    Product product = dtoToEntity(productDTOTwo);
	
	    log.info(product);
	    log.info(product.getImageList());
	
	    Long pno = productRepositoryTwo.save(product).getPno();
	
	    return pno;
	}
	...
}
```

## 4) 서비스 계층 - 테스트 코드 - 상품 등록
```java
public class ProductServiceTwoTests {
	...
	@Test
	public void testRegister() {
	    ProductDTOTwo productDTOTwo = ProductDTOTwo.builder()
	            .pname("새로운 상품")
	            .pdesc("새로운 설명")
	            .price(1000)
	            .build();
	
	    productDTOTwo.setUploadedFileName(
	            java.util.List.of(
	                    UUID.randomUUID() + "_" + "TEST1.jpg",
	                    UUID.randomUUID() + "_" + "TEST2.jpg"
	            )
	    );
	
	    productServiceTwo.register(productDTOTwo);
	}
}
```

## 5) 컨트롤러 계층 구현하기 - 상품 등록
```java
public class ProductControllerTwo {
	...
	@PostMapping("/")
	public Map<String, Long> register(ProductDTOTwo productDTOTwo) {
	    List<MultipartFile> files = productDTOTwo.getFiles();
	    List<String> uploadFileNames = fileUtil.saveFiles(files);
	
	    productDTOTwo.setUploadedFileName(uploadFileNames);
	    log.info(uploadFileNames);
	
	    Long pno = productServiceTwo.register(productDTOTwo);
	    return Map.of("result", pno);
	}
}
```