# Axios 인터셉터와 AccessToken
## 1) Axios 인터셉터
- 로그인에 대한 저장과 애플리케이션 내 상태가 유지되어도 API 서버 호출에는 JWT 방식으로 Access Token 때문에 정삭적으로 실행되지 않는다.
- API 서버는 Access Token을 체크하기 때문에 Axios 호출 시 Access Token 을 전달해야 한다.
- 만료 시, Refresh Token으로 Access Token을 갱신하는 처리도 필요하다.
- Axios는 인터셉터 기능을 제공해서 Axios 요청이나 응답 시 추가적인 작업을 수행할 수 있는데, 이를 통해 쿠키로 보관된 Access Token을 처리하는 작업 및 자동으로 Refresh Token을 사용하는 처리를 할 수 있다.

## 2) Axios 인터셉터를 이용한 함수 구현
- `src/util/jwtUtil.js` 에 파일을 만들어주자.
	- Axios 요청 및 응답 시 동작할 함수들을 정의한다.
- 그리고 이전 `productApi.js`에 있는 `axios....` 부분을 `jwtAxios`로 바꿔준다.
	- `memberApi.js`는 JWT를 사용하지 않는다.
```javascript
import axios from 'axios';
import { getCookie } from './cookieUtil';

const jwtAxios = axios.create();

//before request
const beforeReq = (config) => {
  console.log("before request.............");
  return config;
};

//fail request
const requestFail = (err) => {
  console.log("request error............")
  return Promise.reject(err);
};

//before return response
const beforeRes = async (res) => {
  console.log("before return response...........");
  return res;
};

//fail response
const responseFail = (err) => {
  console.log("response fail error.............");
  return Promise.reject(err);
};

jwtAxios.interceptors.request.use(beforeReq, requestFail);
jwtAxios.interceptors.response.use(beforeRes, responseFail);

export default jwtAxios;
```

## 3) 인터셉터 시 Access Token 전달하기
- Access Token은 로그인 상황에 쿠키에 보관되어 있고 `jwtUtil.js`에서 이를 이용해 API 서버 호출 전에 `Authorization` 헤더를 추가하도록 구성해준다.
- 만약 로그인 쿠키가 없다면 무조건 예외를 발생시킨다.