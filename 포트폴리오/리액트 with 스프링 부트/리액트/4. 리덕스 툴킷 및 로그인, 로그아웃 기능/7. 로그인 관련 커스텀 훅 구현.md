# 로그인 관련 커스텀 훅 구현
## 1) 로그인 커스텀 훅 구현
```javascript
import { useDispatch, useSelector } from 'react-redux';
import { Navigate, useNavigate } from 'react-router-dom'
import { loginPostAsync, logout } from '../slices/loginSlice';

const useCustomLogin = () => {
  const navigate = useNavigate();
  const dispatch = useDispatch();

  const loginState = useSelector(state => state.loginSlice);
  const isLogin = loginState.email ? true : false;

  const doLogin = async (loginParam) => {
    const action = await dispatch(loginPostAsync(loginParam));
    return action.payload
  };

  const doLogout = async () => {
    dispatch(logout());
  };

  const moveToPath = (path) => {
    navigate({ pathname: path }, { replace: true });
  };

  const moveToLogin = () => {
    navigate({ pathname: '/member/login' }, { replace: true });
  };

  const moveToLoginReturn = () => {
    return <Navigate replace to='/member/login' />
  };

  return { loginState, isLogin, doLogin, doLogout, moveToPath, moveToLogin, moveToLoginReturn }
}

export default useCustomLogin;
```

## 2) 로그인 컴포넌트 리팩토링
```javascript
import React, { useState } from 'react';
import useCustomLogin from '../../hooks/useCustomLogin';

const initState = {
  email: '',
  password: ''
}

const LoginComponent = () => {
  const [loginParam, setLoginParam] = useState({ ...initState });

  const { doLogin, moveToPath } = useCustomLogin();

  const handleChange = (e) => {
    loginParam[e.target.name] = e.target.value;
    setLoginParam({ ...loginParam });
  };

  const handleClickLogin = (e) => {
    doLogin(loginParam)
      .then(data => {
        if (data.error) {
          alert('이메일과 패스워드를 확인해주세요.');
        } else {
          moveToPath('/');
        }
      })
  };

  return (
    ...
  );
}

export default LoginComponent;
```

## 3) 로그인 필요한 페이지에 적용하기
- 로그인이 되있으면 어바웃 페이지로, 아니면 로그인 페이지로 이동한다.
```javascript
import React from 'react'
import BasicLayout from '../layouts/BasicLayout';
import useCustomLogin from '../hooks/useCustomLogin';

const AboutPage = () => {
  const { isLogin, moveToLoginReturn } = useCustomLogin();

  if (!isLogin) {
    return moveToLoginReturn();
  }

  return (
    <BasicLayout>
      <div className='text-3xl'>AboutPage</div>
    </BasicLayout>
  );
}

export default AboutPage;
```

## 4) 로그아웃 컴포넌트 리팩토링
```javascript
import React from 'react';
import useCustomLogin from '../../hooks/useCustomLogin';

const LogoutComponent = () => {

  const { doLogout, moveToPath } = useCustomLogin();

  const handleClickLogout = () => {
    doLogout();
    alert('로그아웃되었습니다.');
    moveToPath('/');
  };

  return (
    ...
  );
}

export default LogoutComponent;
```