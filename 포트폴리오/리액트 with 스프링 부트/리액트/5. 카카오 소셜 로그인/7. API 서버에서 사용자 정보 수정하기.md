# 7. API 서버에서 사용자 정보 수정하기
## 1) 스프링부트
### (1) MemberModifyDTO 구현
- `MemberDTO`는 스프링 시큐리티 관련 생성자 함수가 존재하므로 따로 만들어준다.
```java
package org.mall.shoppingmallapi.dto;

import lombok.Data;

@Data
public class MemberModifyDTO {
    private String email;
    private String password;
    private String nickname;
}
```

### (2) modify 메소드 추가하기
- MemberService, MemberServiceImpl에 modify() 메소드를 추가한다.
```java
void modifyMember(MemberModifyDTO memberModifyDTO);
```

```java
    @Override
    public void modifyMember(MemberModifyDTO memberModifyDTO) {
        Optional<Member> result = memberRepository.findById(memberModifyDTO.getEmail());

        Member member = result.orElseThrow();

        member.changeNickname(memberModifyDTO.getNickname());
        member.changeSocial(false);
        member.changePassword(passwordEncoder.encode(memberModifyDTO.getPassword()));

        memberRepository.save(member);
    }
```

### (3) PutMapping 추가하기
- `SocialController` 에 수정에 쓰이는 PutMapping을 추가해준다.
```java
    @PutMapping("/api/member/modify")
    public Map<String, String> modify (@RequestBody MemberModifyDTO memberModifyDTO) {
        memberService.modifyMember(memberModifyDTO);

        return Map.of("result", "modified");
    }
```

## 2) 리액트
### (1) 수정 API 구현
```javascript
export const modifyMember = async (member) => {
  const res = await jwtAxios.put(`${host}/modify`, member);
  return res.data;
};
```

### (2) 수정 컴포넌트에 수정 버튼 구현
```javascript
...
  const handleClickModify = () => {
    modifyMember(member).then(result => {
      setResult('Modified');
    });
  };
...

      <div className="flex justify-center">
        <div className="relative mb-4 flex w-full flex-wrap justify-end">
          <button
            type="button"
            className="rounded p-4 m-2 text-xl w-32 text-white bg-blue-500"
            onClick={handleClickModify}
          >
            Modify
          </button>
        </div>
      </div>
    </div>
  );
}

export default ModifyComponent;
```

### (3) 수정 후 재로그인 하기
```javascript
...
const ModifyComponent = () => {
  const [member, setMember] = useState(initState);
  const loginInfo = useSelector(state => state.loginSlice);
  const [result, setResult] = useState();
  const { moveToLogin } = useCustomLogin();

  ...

  const closeModal = () => {
    setResult(null);
    moveToLogin();
  };
  ...

  return (
    <div className="mt-6">

      {result ? <ResultModal callbackFn={closeModal} title={'회원 정보 수정'} content={'회원 정보 수정 완료'} /> : <></>}
      ...
```