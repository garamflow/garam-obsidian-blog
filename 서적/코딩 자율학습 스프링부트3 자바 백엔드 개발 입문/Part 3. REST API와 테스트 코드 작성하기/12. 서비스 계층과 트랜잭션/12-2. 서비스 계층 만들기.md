# 12-1. 서비스 계층 만들기
- service 패키지를 만들어주고 ArticleService.java 클래스를 만들어준다.
- `@Service` 어노테이션을 붙여준다.
- ArticleApiController.java에서 `@Autowired`로 주입 시켜주던 객체를 `ArticleService`로 교체해준다.
- ArticleService에 `@Autowired`로 `ArticleRepository`를 주입시켜준다.

```java
package com.example.firstproject.service;

import com.example.firstproject.entity.Article;
import com.example.firstproject.repository.ArticleRepository;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import java.util.List;

@Service
public class ArticleService {

    @Autowired
    private ArticleRepository articleRepository;
}
```
## 1) 게시글 조회 요청 개선하기
### (1) 모든 게시글 조회 요청 개선하기
1. 컨트롤러의 `index()` 메소드에서 `return` 문을 `articleService.index();` 로 바꿔준다.
2. 서비스에서 `index()` 메소드를 리파지터리를 통해 데이터를 가져오는 코드로 만들어준다.

```java
@GetMapping("/api/articles")
public List<Article> index() {
    return articleService.index();
}
```

```java
public List<Article> index() {
    return articleRepository.findAll();
}
```

### (2) 단일 게시글 조회 요청 개선하기
1. 컨트롤러의 `show()` 메소드에서 `return` 문을 `articleService.show(id);` 로 바꿔준다.
2. 서비스에서 `show()` 메소드를 리파지터리를 통해 데이터를 가져오는 코드로 만들어준다.

```java
@GetMapping("/api/articles/{id}")
public Article show(@PathVariable Long id) {
    return articleService.show(id);
}
```

```java
public Article show(Long id) {
    return articleRepository.findById(id).orElse(null);
}
```

## 2) 게시글 생성 요청 개선하기
1. 컨트롤러에서 `dto.toEntity()`를 삭제하고 `articleService.create(dto)`를 호출하고 POST 요청 메시지에 담긴 데이터를 전달하기 위해 `dto`를 넣어준다.
2. `create()` 메소드를 통해 얻은 결과는 `created`로 변경시켜준다.
3. 서비스에서 `create()` 메소드로 받아온 결과물인 `created`가 null인 경우와 아닌 경우에 따라 분기처리를 해준다.
	- null이 아니면 `ResponseEntity`의 상태가 `OK`, 본문(body)에는 `created`를 실어 보낸다.
	- null이면 `ResponseEntity`의 상태가 `BAD_REQUEST`, 본문(body)은 빌드만 해서 보낸다.
4. `create()` 메소드의 반환형을 `ResponseEntity<Article>`로 변경시켜준다.
5. 서비스에 `create()` 메소드는 `dto`를 파라미터로 받고, 엔티티로 변환시켜준다.
6. 그리고 리파지터리를 통해 엔티티를 DB에 저장시켜준다.

```java
    @PostMapping("/api/articles")
    public ResponseEntity<Article> create(@RequestBody ArticleForm dto) {
        Article created = articleService.create(dto);
        
        return (created != null)
                ? ResponseEntity.status(HttpStatus.OK).body(created)
                : ResponseEntity.status(HttpStatus.BAD_REQUEST).build();
    }
```

```java
    public Article create(ArticleForm dto) {
        Article article = dto.toEntity();
        return articleRepository.save(article);
    }
```

## 3) 게시글 수정 요청 개선하기
