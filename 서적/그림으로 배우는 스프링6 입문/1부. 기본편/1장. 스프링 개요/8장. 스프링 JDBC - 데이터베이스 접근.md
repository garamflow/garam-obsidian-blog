# 8장. 스프링 JDBC - 데이터베이스 접근
## 8.1 스프링과 데이터베이스 접근
- 스프링에서 사용할 수 있는 데이터베이스 접근 방식은 아래와 같다.
	- 다른 라이브러리와 연동
	- 스프링 데이터
	- 스프링 JDBC

### 1) 다른 라이브러리와의 연동
- MyBatis, JPA 등이 대표적인 예이다.
- 스프링의 트랜잭션 기능과 연동 가능하고, 접근 시 발생하는 예외를 스프링의 예외로 변활할 수 있다.

### 2) 스프링 데이터
- 스프링 프로젝트 중 하나로, 관계형 데이터베이스뿐 아니라 NoSQL 데이터베이스에도 유용한 기능 제공을 한다.
	- Repository의 구상 클래스 자동 생성 등
		- DI 컨테이너 생성 시 메모리 상 구상 클래스 생성
		- 해당 클래스 객체 생성해서 Bean 등록
- 데이터베이스 종류에 따라 '스프링 데이터 JPA', '스프링 데이터 MongDB' 등이 있다.

### 3) 스프링 JDBC
- 스프링 프레임워크에서 제공한다.
- 자바 표준인 JDBC를 좀 더 쉽게 사용할 수 있다.

## 8.2 자바와 데이터베이스 접근
- 어떤 데이터베이스 접근 방식을 사용해서 자바 표준 JDBC가 사용된다.
	- Service -> Repository -> (다양한 방법) -> JDBC - 데이터베이스

## 8.3 스프링 JDBC란?
- 스프링 프레임워크가 제공하는 데이터베이스 접근 기능이다.
- 자바 표준 제공 JDBC를 래핑(wrapping)하여 직접 사용할 때 필요한 정형화되고 중복된 처리를 대신해준다.
	- 중복 처리를 대신해주는 것이라서 처리 속도는 직접 사용할 때와 거의 차이가 없다.
- JDBC를 직접 사용할 수도 있다.

## 8.4 JDBC와 스프링 JDBC 비교
- JDBC의 정형화되고 중복된 코드 작성을 스프링 JDBC에서는 더 간편하게 처리할 수 있다.
- 스프링 JDBC는 애플리케이션 고유의 처리만 작성하면 된다.

## 8.5 스프링 JDBC의 활용 사례
### 1) 처리 속도를 최대한 높이고 싶은 경우
- JDBC와 비교해서는 처리 속도는 거의 차이가 없다.
- 하지만 JDBC를 완전히 래핑해서 많은 기능을 추가했기에, 다른 기술과 비교해서는 처리 속도가 빠르다고 볼 수 있다.

### 2) JDBC에 익숙한 베테랑 개발자가 많은 경우
- JDBC를 얇게 감싼 기술이므로 JDBC에 익숙한 개발자라면 스프링 JDBC를 사용하는 것이 쉽다.

### 3) 레거시 애플리케이션을 리팩터링하는 경우
- JDBC를 직접 사용한 레거시 애플리케이션은 데이터베이스 접근과 관련된 프로그램이 중복되어 있다.
- 유지 관리성을 위해 리팩터링을 할 경우 스프링 JDBCRK GYRHKWJRDLEK.

## 8.6 JdbcTemplate 클래스
- 데이터베이스에 SQL을 실행하는 다양한 메서드를 제공하는 클래스이다.
- 메서드를 호출하기 위해서 JdbcTemplate 객체를 준비할 필요가 있다.
	- new 연산자로 생성자를 호출하면서 DataSource 객체를 인수로 넘겨주면 된다.
	- JdbcTemplate 클래스는 내부에서 DataSource 객체를 사용해 Connection 객체를 가져온다.
```java
DataSource dataSource = ...;
JdbcTemplate jdbcTemplate = new JdbcTemplate(dataSource);
```

## 8.7 검색 계열 처리
### 1) 하나의 컬럼만 가져오기
- 레코드 중 하나의 컬럼만 가져올 때는 `queryForObject` 메서드를 사용한다.
```java
String title = jdbcTemplate.queryForObject(
	"SELECT title FROM training WHERE id = ?", String.class, "t01"
);
```
 - 첫 번째 인수에는 실행할 SQL 문자열을 지정한다.
	 - SQL 파라미터 부분은 ? 기호로 표시한다.
 - 두 번째 인수에는 반환 값으로 반환할 객체의 타입을 지정한다.
 - 세 번째 인수는 ? 기호에 대응하는 파라미터 값을 지정한다.
 - 세 번째 인수 이후는 가변 인수로 ? 기호가 여러 개일 경우 ? 기호 개수만큼 인수를 지정한다.
```java
String title = jdbcTemplate.queryForObject(
	"SELECT title FROM training WHERE id = ? AND title = ?",
	String.class, "t01", "비즈니스 예절 교육"
);
```

```java
List<Integer> reserveds = jdbcTemplate.queryForList(
	"SELECT reserved FROm training", Integer.class
);
```
- 여러 레코드에서 한 컬럼만 가져오려면 위와 같이 작성한다.

### 2) 레코드를 Map 객체로 변환해서 가져오기
- 한 레코드의 데이터를 Map 객체로 가져오려면 `queryForMap` 메서드를 사용한다.
```java
Map<String, Object> map = jdbcTemplate.queryForMap(
	"SELECT * FROM training WHERE id = ?", "t01"
);
```
- 첫 번째 인수는 SQL 문자열이다.
- 두 번째 인수부터는 ? 기호의 파라미터에 대응하는 값을 지정한다.
- 반환 값을 Map 타입이면 Map 객체를 얻게 된다.
	- 컬럼명이 키가 되고 컬럼값이 저장된다.

### 3) 레코드를 Entity 객체로 변환해서 가져오기
- 