# 9장. 선언적 트랜잭션
## 9.1 트랜잭션이란?
- 여러 개의 연관된 처리를 하나의 처리로 다룰 때 단위로 사용되는 용어이다.
- 데이터베이스의 트랜잭션을 활용하면 여러 개의 SQL 실행을 하나의 처리 단위로 다룰 수 있어서 데이터 불일치 상태를 방지할 수 있다.
	- 트랜잭션이 시작되면 여러 개의 SQL을 실행하고, 모든 SQL이 성공하면 마지막으로 확정(커밋, commit)한다. 커밋하면 데이터베이스에 데이터가 저장된다.
	- 만약 중간에 SQL이 실패하면 원래대로 되돌리도록 지시(롤백, rollback)한다.

## 9.2 웹 애플리케이션의 트랜잭션
- 일반적으로 데이터베이스의 트랜잭션은 웹 애플리케이션의 처리 중 업무 로직 메서드가 트랜잭션 단위가 된다.
	- 업무 로직 메서드가 호출되는 시점에 트랜잭션을 시작하고, 업무 로직 메서드가 종료되는 시점에 트랜잭션을 종료한다.

## 9.3 트랜잭션과 커넥션
- 데이터베이스의 트랜잭션은 하나의 커넥션에 대해 이뤄진다. 그러므로 여러 Repository 객체가 하나의 커넥션을 사용해야 한다.
- 커넥션을 가져와 트랜잭션을 시작한 후, 동일한 커넥션을 여러 Repository 객체가 사용하여 SQL을 실행하고, 트랜잭션이 종료되면 커넥션을 닫는다.

## 9.4 트랜잭션을 자체적으로 제어할 때의 문제점
- 여러 개의 Repository 객체에서 동일한 커넥션을 사용하려면 업무 로직 처음에 커넥션을 획득하고, 획득한 커넥션을 Repository 객체의 메서드의 인수로 넘겨주는 방법이 있다.
- 그러나 트랜잭션 제어 처리가 섞여 코드의 가독성이 낮아지고, 중복 코드가 많아진다.

## 9.5 스프링의 선언적 트랜잭션
- 업무 로직 메서드에 @Transactional을 붙이기만 하면 자동으로 트랜잭션 제어가 이루어진다.
- 해당 애너테이션이 붙은 메서드는 호출된 시점에 자동으로 커넥션을 획득하고 트랜잭션이 시작되며, 메서드가 종료되면 자동으로 커밋되고 커넥션이 닫힌다.
- 예외가 발생하면 자동으로 롤백된다.
	- 기본적으로 비검사 예외만 롤백 대상이다.
- 클래스에 붙이면 클래스가 가진 모든 메서드에서 트랜잭션 제어가 이루어진다.

## 9.6 트랜잭션의 내부 구조
