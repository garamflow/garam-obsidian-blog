# 캐시 메모리
- CPU가 메모리에 접근하는 시간은 CPU 연산 속도보다 느리다.

## 1) 저장 장치 계층 구조 (Memory Hierarchy)
- CPU와 가까운 저장 장치는 빠르고, 멀리 있는 저장 장치는 느리다.
- 속도가 빠른 저장 장치는 저장 용량이 작고, 가격이 비싸다.
	- 레지스터 vs 메모리(RAM) vs USB 메모리
	- 낮은 가격대의 대용량 저장 장치를 원한다면 느린 속도는 감수해야 하고, 빠른 속도의 저장 장치를 워한다면 작은 용량과 비싼 가격은 감수해야 한다.
- 저장 장치 계층 구조는 각기 다른 용량과 성능의 저장 장치들을 계층화하여 표현한 구조이다.
- 저장 장치들은 `CPU에 얼마나 가까운가`를 기준으로 계층적으로 나타낼 수 있다.
![저장 장치 계층 구조](/media/Computer%20Science/개념%20강의%20정리/강민철/개발자를%20위한%20컴퓨터%20공학%201,%20혼자%20공부하는%20컴퓨터구조%20+%20운영체제/6.%20메모리와%20캐시%20메모리/저장%20장치%20계층%20구조.svg)

## 2) 캐시 메모리
- CPU와 메모리 사이에 위치해있으며 레지스터보다 용량이 크고 메모리보다 빠른 SRAM기반의 저장 장치이다.
- CPU의 연산 속도와 메모리 접근 속도의 차이를 조금이나마 줄이기 위해 탄생했다.
- "CPU가 매번 메모리에 왔다갔다 하는 건 시간이 오래 걸리니, 메모리에서 CPU가 사용할 일부 데이터를 미리 캐시 메모리로 가지고 와서 쓰자" 라는 의견으로 사용하게 되었다.
- 예시
	- 메모리에 접근 = 물건을 사러 가는 것
	- 메모리 = 물건은 많지만 집과는 멀이 떨어져 있는 왕복이 오래 걸리는 대형 마트
	- 캐시 메모리 = 물건이 많지는 않아도 집과 가까이 있는 편의점
![캐시 메모리가 추가된 저장 장치 계층 구조](/media/Computer%20Science/개념%20강의%20정리/강민철/개발자를%20위한%20컴퓨터%20공학%201,%20혼자%20공부하는%20컴퓨터구조%20+%20운영체제/6.%20메모리와%20캐시%20메모리/캐시%20메모리가%20추가된%20저장%20장치%20계층%20구조.svg)

### (1) 계층적 캐시 메모리 (L1-L2-L3 캐시)
- 일반적으로 L1, L2캐시는 코어 내부에, L3캐시는 코어 외부에 위치해 있다.
![계층적 캐시 메모리](/media/Computer%20Science/개념%20강의%20정리/강민철/개발자를%20위한%20컴퓨터%20공학%201,%20혼자%20공부하는%20컴퓨터구조%20+%20운영체제/6.%20메모리와%20캐시%20메모리/계층적%20캐시%20메모리.svg)

### (2) 멀티코어 프로세서의 캐시 메모리
![멀티코어 프로세서의 캐시 메모리](/media/Computer%20Science/개념%20강의%20정리/강민철/개발자를%20위한%20컴퓨터%20공학%201,%20혼자%20공부하는%20컴퓨터구조%20+%20운영체제/6.%20메모리와%20캐시%20메모리/멀티코어%20프로세서의%20캐시%20메모리.svg)

### (3) 분리형 캐시
![분리형 캐시](/media/Computer%20Science/개념%20강의%20정리/강민철/개발자를%20위한%20컴퓨터%20공학%201,%20혼자%20공부하는%20컴퓨터구조%20+%20운영체제/6.%20메모리와%20캐시%20메모리/분리형%20캐시.svg)

## 3) 참조 지역성의 원리
- 캐시 메모리는 메모리보다 용량이 작다.
- 당연하게도 메모리의 모든 내용을 저장할 수 없다.
- 그렇다면 뭘 저장해야 할까?
	- CPU가 자주 사용할 법한 내용을 예측하여서 저장해야한다.
- 캐시 적중률을 높여야 한다.
	- == CPU가 사용할 법한 데이터를 잘 예측해야 한다.
- CPU가 사용할 법한 데이터를 예측하는 방법을 참조 지역성의 원리라고 한다.

### (1) 캐시 히트
- 예측이 들어맞아서 CPU가 캐시 메모리에 저장된 값을 활용하는 경우를 말한다.

### (2) 캐시 미스
- 예측이 틀려서 CPU가 메모리에 직접 접근해야 하는 경우를 말한다.
	- 성능 하락이 일어난다.

### (3) 캐시 적중률
- `캐시 히트 횟수 / (캐시 히트 횟수 + 캐시 미스 횟수)`

### (4) 참조 지역성의 원리
- CPU가 메모리에 접근할 때의 주된 경향을 바탕으로 만들어진 원리이다.
	1. CPU는 최근에 접근했던 메모리 공간에 다시 접근하려는 경향이 있다.
	2. CPU는 접근한 메모리 공간 근처를 접근하려는 경향이 있다. (공간 지역성)
- 예시
	1. 변수를 다시 접근하는 경향이 있다.
	2. 워드 프로세서 메모리 공간 내부에 저장 기능, 입력 기능 등이 모여있을테니 공간을 접근하는 경향이 있다.